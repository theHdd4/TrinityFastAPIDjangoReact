Laboratory Card Generation API
===============================

Endpoint
--------
- **Method:** `POST`
- **URL:** `/api/laboratory/cards`
- **Description:** Creates a new laboratory card scaffold (including a single atom) and returns the hydrated card payload for the Laboratory Mode canvas. This endpoint replaces the previous purely client-side card creation step so that every card instantiation emits a backend event.

Request Body
------------
Send JSON with the following fields:

| Field        | Type     | Required | Description |
|--------------|----------|----------|-------------|
| `atomId`     | string   | Yes      | The identifier of the atom to place in the new card (e.g. `"feature-overview"`). |
| `moleculeId` | string   | No       | Optional molecule identifier used to group cards in the UI. |
| `source`     | "manual" \| "ai" | No | Origin of the request. Defaults to `"manual"`. |
| `llm`        | string   | No       | Optional attribution for the LLM that generated the card. |
| `settings`   | object   | No       | Optional initial settings payload for the atom. When omitted the frontend applies its own defaults. |

Response Body
-------------
Returns HTTP `200` with a JSON object describing the created card:

```
{
  "id": "card-<uuid>",
  "atoms": [
    {
      "id": "<atom-id>-<uuid>",
      "atomId": "<atom-id>",
      "source": "manual",
      "llm": null,
      "settings": null
    }
  ],
  "isExhibited": false,
  "moleculeId": "<optional>",
  "moleculeTitle": null
}
```

- `id` is a server-generated unique identifier for the card.
- Each entry in `atoms` represents an atom instance created for the card. Additional metadata (title, color, defaults) is enriched client-side using the existing registries.
- `moleculeTitle` is returned as `null` because the frontend maintains the molecule catalogue and fills the title based on `moleculeId`.

Error Responses
---------------
- `422` with `{ "detail": "atomId is required" }` if the request omits the atom identifier.
- `500` for unexpected server-side errors.

Usage Notes
-----------
- The frontend calls this endpoint whenever a new card is dropped/added in Laboratory Mode. If the request fails, the UI gracefully falls back to the legacy in-browser card construction and surfaces a toast notification.
- Provide optional `settings` if a backend workflow needs to preconfigure the atom. When omitted, the frontend derives defaults identical to the previous behaviour.
