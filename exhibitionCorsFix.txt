Exhibition save failures analysis
=================================

Issue summary
-------------
* Browser console showed a blocked request to ``/api/exhibition/layout`` because the backend omitted ``Access-Control-Allow-Origin`` for the active origin ``http://192.168.1.7:8080``.
* FastAPI logs surfaced ``pymongo.errors.OperationFailure: command update requires authentication`` when the exhibition layout attempted to persist changes.

Root causes
-----------
1. The FastAPI service only whitelisted a fixed set of origins and runtime IP heuristics. When the deployment injects ``FRONTEND_URL`` (e.g. ``http://192.168.1.7:8080``) the origin was not added automatically, so CORS preflight responses lacked the header that modern browsers require.
2. The exhibition MongoDB dependency used environment variables for credentials only when they were provided. In deployments that supply ``EXHIBITION_MONGO_URI`` without embedded credentials and omit explicit ``MONGO_USERNAME``/``MONGO_PASSWORD`` values, the client connected without authenticating, triggering the ``command update requires authentication`` error on writes.

Fix implemented
---------------
* ``FRONTEND_URL`` is now parsed and added (with host/port variants) to the default CORS allow list so requests from ``:8080`` style frontends receive the proper headers.
* Added a private-network CORS regex fallback so any RFC1918 host (including dynamically assigned ``10.x.x.x`` and ``192.168.x.x`` addresses referenced in docker compose files) is trusted automatically alongside explicit origin entries.
* The Mongo helper now falls back to the production-aligned ``root``/``rootpass`` credentials (matching ``docker-compose``) when username or password variables are absent, ensuring authenticated writes even when ``EXHIBITION_MONGO_URI`` omits inline credentials.
* Saving exhibition layouts now uses a dedicated ``exhibition_list_configuration`` pipeline that mirrors the laboratory logic while targeting the exhibition collection. The Mongo writes authenticate with the ``root``/``rootpass`` defaults before the layout document is updated.
* The async layout saver now builds a Mongo URI that explicitly targets ``trinity_db`` so ``exhibition_list_configuration`` entries are only written to the intended database instead of duplicating into ``trinity``.
* Exhibition layout persistence now stores slide-centric documents (``slide_id``, curated components, and slide objects) so the ``exhibition_list_configuration`` collection reflects the actual slide composition rather than individual atom rows or laboratory card payloads.
* Laboratory mode no longer mirrors card state into the exhibition store, eliminating the automatic creation of exhibition slides whenever atoms are dragged on the laboratory canvas.
* Laboratory cards no longer expose an "Exhibit this card" toggle; the exhibition catalogue remains available and renders components exclusively based on staged exhibition selections.

Validation
----------
* Confirmed that the updated CORS configuration exposes the origin list including any hostname extracted from ``FRONTEND_URL``.
* Ensured that saving an exhibition layout exercises the new ``exhibition_list_configuration`` pipeline with authenticated Mongo credentials when explicit values are not configured, preventing the prior ``OperationFailure`` and aligning data storage across modes.
